<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Components Screen readers are complex applications that need to interact with many different systems and technologies, and Odilia is no different. For this reason, the project is split into several crates:
Odilia &ndash; The main application This is the toplevel binary crate, which glues all the smaller crates together. It also handles logging and other application-wide tasks.
atspi &ndash; Accessibility Interface This crate communicates with the Assistive Technology Service Provider Interface, which allows Odilia to access and present the content in applications and the desktop environment."><meta name=theme-color media="(prefers-color-scheme: light)" content="white"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#141414"><link rel=license type=text/html href=https://www.gnu.org/licenses/agpl-3.0-standalone.html><link rel=license type=text/html href=https://creativecommons.org/licenses/by-sa/4.0/><link rel=stylesheet type=text/css href=/css/style.css encoding=UTF-8><link rel=stylesheet type=text/css href=/css/syntax.css encoding=UTF-8><title>Design Overview | Odilia Screen Reader</title></head><body><div id=container><nav class=global-nav><ul class=nav-list><li class=nav-item><a href=/ class=nav-link>Home</a></li><li class=nav-item><a href=/news/ class=nav-link>News</a></li><li class=nav-item><a href=/design/ class=nav-link>Design</a></li><li class=nav-item><a href=/doc/ class="nav-link active" aria-current=true>Documentation</a></li><li class=nav-item><a href=/community/ class=nav-link>Community</a></li><li class=nav-item><a href=https://github.com/odilia-app class=nav-link>Code</a></li></ul></nav><main><nav class=local-nav aria-label=local><a class=local-nav-prev href=/doc/devel/useful-links/ title="Prev: Useful Links" aria-label=Previous>&larr;</a>
<span aria-label=Breadcrumbs><a href=/>Home</a>
/ <a href=/doc/>Documentation</a>
/ <a href=/doc/devel/>Developer Documentation</a></span></nav><article><header><h1>Design</h1></header><h2 id=components>Components</h2><p>Screen readers are complex applications that need to interact with many different systems and technologies, and Odilia
is no different. For this reason, the project is split into several crates:</p><h3 id=odiliarepo----the-main-application><a href=https://github.com/odilia-app/odilia>Odilia</a> &ndash; The main application</h3><p>This is the toplevel binary crate, which glues all the smaller crates together. It also handles logging and other
application-wide tasks.</p><h3 id=atspiatspi-crate----accessibility-interface><a href=https://github.com/odilia-app/atspi>atspi</a> &ndash; Accessibility Interface</h3><p>This crate communicates with the <a href=https://www.freedesktop.org/wiki/Accessibility/AT-SPI>Assistive Technology Service Provider Interface</a>, which allows Odilia to
access and present the content in applications and the desktop environment.</p><h3 id=odilia-cacheodilia-cache----a-cache-for-accessibile-items-on-the-desktop><a href=https://github.com/odilia-app/odilia/tree/main/cache>odilia-cache</a> &ndash; A Cache for Accessibile Items on the Desktop</h3><p>This subsystem handles a cache that makes Odilia very fast.
If you want to help in the performance department of Odilia, this is what to look at.
Help us make the hashmap easier to index, the references faster to dereference, and the cache items easier to copy.</p><h3 id=odilia-commonodilia-common----common-algorithms-data-types-and-structures><a href=https://github.com/odilia-app/odilia/tree/main/common>odilia-common</a> &ndash; Common Algorithms, Data Types and Structures</h3><p>These are miscellaneous pieces of code shared by other Odilia crates. Among them are the code necessary to parse and
work with keybindings, types used in structural navigation, and types used to read configuration files.</p><h3 id=odilia-inputodilia-input----input-methods-and-events><a href=https://github.com/odilia-app/odilia/tree/main/input>odilia-input</a> &ndash; Input Methods and Events</h3><p>This crate is responsible for handling input events from devices such as keyboards, mice, and touch screens.
It doesn&rsquo;t implement any input methods, it only allows input methods to be configured.</p><h3 id=odilia-ttsodilia-tts----text-to-speech><a href=https://github.com/odilia-app/odilia/tree/main/tts>odilia-tts</a> &ndash; Text to Speech</h3><p>This handles talking to <a href=https://freebsoft.org/speechd>speech-dispatcher</a> for text to speech synthesis, as well as formatting messages to be
spoken.</p><h2 id=dependencies-and-technologies>Dependencies and Technologies</h2><h3 id=tokiotokio----asynchronous-runtime><a href=https://tokio.rs>Tokio</a> &ndash; Asynchronous Runtime</h3><p>On Unix-like operating systems, IPC is usually handled using <a href=https://manpages.ubuntu.com/manpages/kinetic/en/man7/unix.7.html>Unix
domain</a> <a href=https://manpages.ubuntu.com/manpages/kinetic/en/man7/socket.7.html>sockets</a> (UDS). These sockets act very similar to
networking sockets: they&rsquo;re an asynchronous method of communication, where data
could arrive at any time.</p><p>For this reason, we&rsquo;ve chosen an asynchronous architecture, which can react to
events as they arrive, and can parallelise the sending and receiving of data
through cooperative multitasking.</p><p>Odilia uses the <a href=https://tokio.rs>Tokio runtime</a> to achieve this. A good knowledge of Tokio is one of the fundamental building
blocks to understanding, and contributing to, the Odilia codebase, so go take a look at the <a href=https://docs.rs/tokio>Tokio
documentation</a>.</p><p>Tokio integrates with Rust&rsquo;s built-in async / await syntax and <a href=https://doc.rust-lang.org/stable/std/future/index.html>Futures</a>, so if you&rsquo;re unfamiliar with them,
the <a href=https://rust-lang.github.io/async-book/>Rust Async Book</a> is a good place to start.</p><h3 id=dbusdbus----inter-process-communication><a href=https://www.freedesktop.org/wiki/Software/dbus/>DBus</a> &ndash; Inter-Process Communication</h3><p>Accessibility naturally requires inter-process communication (IPC), so that
assistive technologies like Odilia can get information from, and send events
to, the applications they&rsquo;re presenting to the user. On the Linux desktop, this is handled by <a href=https://www.freedesktop.org/wiki/Software/dbus/>DBus</a>.</p><p>We use the <a href=https://crates.io/crates/zbus>zbus crate</a> (<a href=https://dbus.pages.freedesktop.org/zbus/1.0/>book</a>) to talk over DBus. It is asynchronous by default, and integrates well with the <a href=#tokiotokio----asynchronous-runtime>Tokio async runtime</a>.</p><p>Most of the <a href=#atspiatspi-crate----accessibility-interface>atspi crate</a> was generated using <a href=https://crates.io/crates/zbus_xmlgen>zbus_xmlgen</a>
from the <a href=https://gitlab.gnome.org/GNOME/at-spi2-core/-/tree/main/xml>at-spi DBus interface XML definitions</a>. Note, however, that zbus_xmlgen is, at present, meant to be
run once, and the generated bindings are to be manually tweaked and kept up to date, in order to keep them idiomatic.</p><footer>Last modified: <time datetime=2022-08-12>August 12, 2022</time></footer></article></main><footer id=footer>Copyright &copy; 2024
<a href=https://github.com/orgs/odilia-app/people target=_blank>the Odilia developers</a>
(Code is <a rel=license href=https://www.gnu.org/licenses/agpl-3.0-standalone.html target=blank>AGPL 3</a>,
content is <a rel=license href=https://creativecommons.org/licenses/by-sa/4.0/ target=blank>CC-BY-SA 4.0</a>)</footer></div></body></html>